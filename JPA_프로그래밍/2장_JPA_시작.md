### H2 database

- 설치가 필요 없음
- 용량 가벼움
- 웹용 쿼리툴 제공

### 하이버네이트 라이브러리

- hibernate-core: 하이버네이트 라이브러리
- hibernate-entitymanager: 하이버네이트가 JPA구현체로 동작하도록 JPA 표준을 구현한 라이브러리

    jpa-api와 core라이브러리도 함께 내려받음

- hibernate-jpa-2.1-api: JPA 2.1 표준 API를 모아둔 라이브러리

# 2.6 어플리케이션 개발

## 2.6.1 엔티티 매니저 설정

### 엔티티 매니저 팩토리 생성

persistence의 설정 정보를 사용해서 엔티티 매니저 팩토리를 생성한다.

엔티티 매니저 팩토리는 어플리케이션 전체에서 딱 한번만 생성하고 공유해서 사용해야 한다.

### 엔티티 매니저 생성

엔티티 매니저 팩토리에서 엔티티 매니절르 생성한다.

JPA의 기능 대부분은 엔티티 매니저가 제공한다.

엔티티 매니저는 데이터 베이스 커넥션과 밀접한 관계가 있으므로 스레드 간의 공유하거나 재사용하면 안됨

### 종료

사용이 끝난 엔티티 매니저, 팩토리는 반드시 종료

## 2.6.2 트랜잭션 관리

JPA는 항상 트랙잭션 안에서 데이터를 변경해야 한다.

트랜잭션 없이 데이터를 변경하면 예외가 발생한다.

트랜잭션 API를 사용하여 비즈니스 로직이 정상 동작하면 커밋, 예외 발생시 롤백한다.

## 2.6.3 비즈니스 로직

JPA는 어떤 엔티티가 변경되었는지 추적하는 기능을 갖추고 있다.

## 2.6.4 JPQL

JPA를 사용하면 개발자는 엔티티 객체 중심으로 개발하고

데이터 베이스에 대한 처리는 JPA에 맡겨야 한다.

문제는 검색 쿼리이다.

테이블이 아닌 엔티티 객체를 대상으로 검색하려면

데이터베이스의 모든 데이터를 어플리케이션으로 불러와서 엔티티 객체로 변경한 다음 검색해야 함

필요한 데이터만 데이터베이스에서 불러오려면 결국 검색 조건이 포함된 SQL을 사용해야 함

### JPQL vs SQL

- JPQL: 엔티티 객체를 대상으로 쿼리. 즉, 클래스와 필드를 대상으로 쿼리
- SQL: 데이터베이스 테이블을 대상으로 쿼리

JPQL은 데이터베이스 테이블을 전혀 알지 못한다.
