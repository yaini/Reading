### 방향

단방향, 양방향

### 다중성

다대일, 일대다, 일대일, 다대다

### 연관관계의 주인

객체를 양방향 연관관계로 만들면 연관관계의 주인을 정해야 한다.

# 5.1 단방향 연관관계

### 객체 연관관계 vs 테이블 연관관계 정리

- 객체는 참조(주소)로 연관관계를 맺는다.
- 테이블은 외래 키로 연관관계를 맺는다.

# 5.2 연관관계 사용

## 5.2.1 저장

JPA에서 엔티티를 저장할 때 연관된 모든 엔티티는 영속 상태여야 한다

## 5.2.2 조회

### 연관관계가 있는 엔티티를 조회하는 방법

- 객체 그래프 탐색(객체 연관관계를 사용한 조회)
- 객체 지향 쿼리 사용(JPQL)

# 5.4 연관관계의 주인

테이블은 외래 키 하나로 두 테이블의 연관관계를 관리한다.

엔티티를 양방향 연관관계로 설정하면 객체의 참조는 둘인데 외래 키는 하나이기 때문에 둘 사이에 차이가 발생한다.

이로 인해 두 객체 연관관계 중 하나를 정해서 테이블의 외래키를 관리해야 하는데 이것을 연관관계의 주인이라고 한다.

## 5.4.1 양방향 매핑의 규칙: 연관관계의 주인

연관관계 주인만 데이터베이스 연관관계와 매핑되고, 외래 키를 관리할 수 있다.

주인이 아닌 쪽은 읽기만 할 수 있음

주인이 아닌 쪽에서 mappedBy 속성을 사용해서 연관관계 주인 설정

ManyToOne에서 Many에 연관관계 주인을 주면 자신의 테이블에 있는 외래키(One) 만 관리하면 되지만, One에 연관관계 주인을 주면 전혀 다른 테이블에 있는 외래 키(Many)를 관리해야 하므로 Many에 준다.

## 5.4.2 연관관계의 주인은 외래 키가 있는 곳

연관관계의 주인은 테이블에 외래 키가 있는 곳으로 정해야 한다.

# 5.5 양방향 연관관계 저장

주인이 아닌 곳에 입력된 값은 외래 키에 영향을 주지 않는다.

연관관계의 주인에 입력된 값을 사용해서 외래 키를 관리한다.

# 5.6 양방향 연관관계의 주의점

연관관계의 주인이 아닌 곳에 값을 입력하면 데이터 베이스에 외래 키 값이 저장되지 않는다.

## 5.6.1 순수한 객체까지 고려한 양방향 연관관계

객체 관점에선 주인이 아닌 곳까지 모두 값을 입력해주는 것이 안전하다.

## 5.6.2 연관관계 편의 메소드

연관관계의 주인 쪽에 객체를 수정하는 메소드를 추가해주어야 한다.

## 5.6.3 연관관계 편의 메소드 작성 시 주의사항

기존 연관관계가 있으면 삭제하는 코드를 추가해야 한다.
