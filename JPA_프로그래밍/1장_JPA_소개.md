### JPA 장점

- CRUD SQL 작성하지 않아도 됨
- 조회 결과를 객체의 매핑하는 작업 자동화
- 생산성, 유지보수 향상

# 1.1 SQL을 직접 다룰 때 발생하는 문제점

객체를 데이터 베이스에 CRUD하려면 너무 많은 SQL과 JDBC API를 코드로 작성해야 한다.

- 엔티티: 비즈니스 요구사항을 모델링한 객체

### 문제점

- 진정한 의미의 계층 분할이 어렵다.
- 엔티티를 신뢰할 수 없다.
- SQL에 의존적인 개발을 피하기 어렵다.

### JPA 객체 CRUD API

- 저장 `persist`: 객체를 데이터베이스에 저장
- 조회 `find`: 객체 하나를 데이터베이스에서 조회
- 수정, 삭제: 객체를 조회해서 값을 변경하면 트랜잭션을 커밋할때 변경이 일어남

# 1.2 패러다임의 불일치

객체와 관계형 데이터베이스는 지향하는 목적이 서로 다르므로 둘의 기능과 표현 방법도 다르다.

따라서 객체 구조를 테이블 구조에 저장하는 데는 한계가 있다.

## 1.2.1 상속

객체는 상속이 있지만 테이블은 없다.

그나마 데이터베이스 모델링에서 슈퍼타입/서브타입 관계를 사용하여 유사하게 설계 가능

상속된 클래스를 조회, 수정할 때마다 추가적인 쿼리를 작성해야 한다.

## 1.2.2 연관관계

객체는 참조에 접근하여 연관된 객체를 조회, 객체는 참조가 있는 방향으로만 조회 가능

테이블은 외래키를 가지고 조인을 사용하여 연관된 테이블 조회

→ 변환 역할을 개발자가 해야함

⇒ JPA는 이러한 패러다임 불일치 문제 해결

## 1.2.3 객체 그래프 탐색

SQL을 직접 다루면 처음 실행하는 SQL에 따라 객체 그래프를 어디까지 탐색할 수 있는지 정해진다.

비즈니스 로직에 따라 사용하는 개체 그래프가 다른데 언제 끊어질지 모르는 객체 그래프를 함부로 탐색 불가능

→ 결국 조회하는 객체에 따라 SQL을 생성해야 함

⇒ **지연로딩**: JPA는 연관된 객체를 사용하는 시점에 적절한 SELECT SQL을 실행, transparent하게 처리

## 1.2.4 비교

데이터 베이스는 기본키의 값으로 구분

객체는 동일성`==` 비교, 동등성`equals` 비교로 구분

⇒ JPA는 같은 트랜잭션일 때, 같은 객체가 조회되는 것을 보장. **동일성 비교 성공**

# 1.3 JPA란 무엇인가?

JPA는 자바 진영의 ORM 기술 표준이다. 어플리케이션과 JDBC 사이에서 동작한다.

ORM은 객체와 관계형 데이터 베이스를 매핑한다는 뜻

ORM 프레임워크의 성숙도에 따라 객체를 CRUD하는 정도의 기능, 패러다임 불일치 문제를 해결해주는 기능이 다름

## 1.3.1 JPA 소개

### EJB

- 과거 자바 진영 ORM 기술 표준
- J2EE 어플리케이션 서버에서만 동작
- 복잡하고 성숙도 떨어짐

### 하이버네이트

- 오픈소스 ORM 프레임 워크
- J2EE 어플리케이션 서버 없이도 동작
- 가볍고 실용적이며 성숙도 높음

JPA는 자바 ORM기술에 대한 API 표준 명세다. 쉽게 말해 인터페이스를 모아둔 것

JPA를 구현한 ORM프레임 워크는 Hibernate, EclipseLink, DataNucleus 가 있다.

## 1.3.2 왜 JPA를 사용해야 하는가?

### 생산성

자바 컬렉션에 객체를 저장하듯이 JPA에게 저장할 객체를 전달하면 됨

CRUD용 SQL을 직접 작성하지 않아도 된다.

### 유지보수

필드를 추가, 삭제할 때 수정해야 할 코드가 줄어듬

패러다임 불일치 문제를 해결해주므로 객체지향 언어가 가진 장점으로 좋은 도메인 모델을 편리하게 설계

### 성능

어플리케이션과 데이터베이스 사이에서 다양한 성능 최적화 제공

같은 트랜잭션 안에 같은 조회 쿼리가 중복된다면 한번만 데이터 베이스에 전달

하이버네이트는 SQL 힌트를 넣을 수 있는 기능도 제공

### 데이터 접근 추상화와 벤더 독립성

추상화된 접근 계층을 제공해서 애플리케이션이 특정 데이터베이스 기술에 종속되지 않도록 한다.

데이터 베이스를 변경하면 JPA에게 다른 데이터베이스를 사용한다고 알려주기만 하면 됨

예를 들어, 로컬 개발 환경과 상용 환경 데이터 베이스 구분

### 표준

표준을 사용하면 다른 구현 기술로 손쉽게 변경 가능
