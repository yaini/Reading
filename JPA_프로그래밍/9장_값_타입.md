JPA의 데이터 타입은 엔티티 타입과 값 타입으로 나눈다.

### 엔티티 타입

@Entity로 정의하는 객체

### 값 타입

값으로 사용하는 자바 기본 타입이나 객체

기본 값 타입, 임베디드 타입, 컬렉션 값 타입으로 나눌 수 있다.

# 9.1 기본값 타입

자바 기본 타입, 래퍼 클래스, String이 있다.

# 9.2 임베디드 타입(복합 값 타입)

새로운 값 타입을 직접 정의

기본 생성자 필수

엔티티와 임베디드 타입의 관계를 UML로 표현하면 컴포지션 관계

## 9.2.2 임베디드 타입과 연관관계

임베디드 타입은 값 타입을 포함하거나 엔티티를 참조할 수 있다.

## 9.2.3 @AttributeOverride: 속성 재정의

임베디드 타입에 정의한 매핑정보를 재정의

## 9.2.4 임베디드 타입과 null

임베디드 타입이 null이면 매핑한 컬럼 값은 모두 null이 된다.

# 9.3 값 타입과 불변 객체

## 9.3.1 값 타입 공유 참조

임베디드 타입 같은 값 타입을 여러 엔티티에서 공유하면 값이 참조되기 때문에 위험하다.

## 9.3.2 값 타입 복사

값 타입의 실제 인스턴스를 공유하기 보다 복사해서 사용해야 함

## 9.3.3 불변 객체

객체를 불변하게 만들면 값을 수정할 수 없으므로 위와 같은 부작용이 일어나지 않는다.

따라서 값 타입은 될 수 있으면 불변 객체로 설계해야 한다.

# 9.4 값 타입의 비교

- 동일성 비교: 인스턴스의 참조 값 비교, == 사용
- 동등성 비교: 인스턴스의 값 비교, equals 사용

# 9.5 값 타입 컬렉션

값 타입을 하나 이상 저장하려면 컬렉션에 보관하고 @ElementCollection, @CollectionTable 어노테이션을 사용하면 됨

영속성 전이+고아 객체 제거 기능을 필수로 가진다.

## 9.5.2 값 타입 컬렉션의 제약사항

엔티티는 식별자가 있으므로 엔티티의 값을 변경해도 식별자로 데이터베이스에 저장된 원본 데이터를 쉽게 찾아서 변경할 수 있다.

반면 값 타입은 단순한 값들의 모음이므로 원본 데이터를 찾기 어렵다.

따라서 JPA 구현체들은 값 타입 컬렉션에 변경 사항이 발생하면, 값 타입 컬렉션이 매핑된 테이블의 연관된 모든 데이터를 삭제하고, 현재 값 타입 컬렉션 객체에 있는 모든 값을 데이터베이스에 다시 저장한다.

따라서 값 타입 컬렉션이 매핑된 테이블에 데이터가 많다면 일대다 관계를 고려해야 한다.

값 타입 컬렉션을 매핑하는 테이블은 모든 컬럼을 묶어서 기본 키를 구성한다.

따라서 컬럼에 null을 입력할 수 없고, 같은 값을 중복해서 저장할 수 없다.
