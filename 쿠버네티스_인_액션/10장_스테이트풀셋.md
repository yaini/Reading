# 파드 복제

파드 템플릿에 퍼시스턴트 볼륨 클레임에 관한 참조가 있으므로 각 레플리카가 별도의 클레임을 사용하도록 만들 수 없다.

별도의 스토리지를 필요로 하는 분산 데이터 저장소를 실행하려면 레플리카셋, 혹은 단일 레플리카셋을 사용할 수 없다.

## 개별 스토리지 레플리카 실행

- 수동으로 파드 생성
    - 레플리카셋 사용 불가
- 파드 인스턴스별 하나의 레플리카 실행
    - 유지보수 번거로움
- 동일 볼륨 여러 개 디렉토리로 사용
    - 다른 인스턴스가 사용하지 않는 데이터 디렉토리를 자동으로 선택
    - 인스턴스 간 조정 필요, 공유 스토리지 볼륨에 병목 현상 발생
- 각 파드 인스턴스별 전용 서비스 생성
    - 파드 IP가 아닌 서비스 IP를 통해 네트워크 주소 제공
    

# 스테이트풀 셋

스테이트풀셋으로 생성된 파드는 서수 인덱스 할당, 서수 인덱스로 부터 생성된 이름 보유

### 거버닝 헤드리스 서비스

각 파드에게 실제 네트워크 아이덴티티 제공

자체 DNS 엔트리를 가짐, 클러스터의 피어 혹은 다른 클라이언트가 호스트 이름을 통해 파드 주소 지정 가능

### 스케일링

- 스케일업: 다음 서수 인덱스를 가지는 파드 인스턴스 생성
- 스케일다운: 가장 높은 서수 인덱스를 먼저 제거, 한 시점에 하나의 파드만 스케일 다운 가능

### 볼륨 클레임 템플릿

파드 생성과 마찬가지로 생성

## 피어 디스커버리

클러스터의 다른 멤버

### SRV 레코드

특정 서비스를 제공하는 서버의 호스트 이름과 포트 이름을 가리키는데 사용

 

## 실패 처리

스테이트풀셋은 파드가 더 이상 실행되지 않는다는 것을 확신할 때까지 대체 파드를 생성할 수 없으며, 생성해서도 안된다.

kubelet이 전달한 정보를 클러스터 관리자가 알려줘야만 알 수 있다. 노드가 연결 불가한 경우, 파드를 강제로 삭제해주어야 한다.
